import{a as U,u as G,T as j,g as z,d as O}from"./table.e8384294.js";import{d as N,L as P,k as v,_ as S,r,o as c,q as _,w as n,b as l,c as C,F as k,x as A,e as y,t as D,j as B,D as J,a as w,G as H,H as I,E as M}from"./index.0b1ad4d3.js";import{P as K}from"./Plus.ac9371e9.js";import{S as Q}from"./Search.b192f559.js";import{D as R}from"./Delete.74bd072d.js";const L=[{value:1,label:"\u8FD0\u52A8"},{value:2,label:"\u5065\u8EAB"},{value:3,label:"\u8DD1\u9177"},{value:4,label:"\u8857\u821E"}],q=[{value:1,label:"\u4ECA\u5929"},{value:2,label:"\u660E\u5929"},{value:3,label:"\u540E\u5929"}],W=N({components:{Layer:P},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const s=v(null),f=v(null);let d=v({name:"",choose:"",radio:"",number:""});const h={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],number:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u5B57",trigger:"blur"}],choose:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}],radio:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}]};u();function u(){e.layer.row&&(d.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:d,rules:h,layerDom:f,ruleForm:s,selectData:L,radioData:q}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){U(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){G(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function X(e,a,s,f,d,h){const u=r("el-input"),i=r("el-form-item"),F=r("el-option"),p=r("el-select"),$=r("el-radio"),m=r("el-radio-group"),g=r("el-form"),t=r("Layer",!0);return c(),_(t,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:n(()=>[l(g,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:n(()=>[l(i,{label:"\u540D\u79F0\uFF1A",prop:"name"},{default:n(()=>[l(u,{modelValue:e.form.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e.form.name=o),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u6570\u5B57\uFF1A",prop:"number"},{default:n(()=>[l(u,{modelValue:e.form.number,"onUpdate:modelValue":a[1]||(a[1]=o=>e.form.number=o),oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"\u53EA\u80FD\u8F93\u5165\u6B63\u6574\u6570"},null,8,["modelValue"])]),_:1}),l(i,{label:"\u9009\u62E9\u5668\uFF1A",prop:"select"},{default:n(()=>[l(p,{modelValue:e.form.choose,"onUpdate:modelValue":a[2]||(a[2]=o=>e.form.choose=o),placeholder:"\u8BF7\u9009\u62E9",clearable:""},{default:n(()=>[(c(!0),C(k,null,A(e.selectData,o=>(c(),_(F,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"\u5355\u9009\u6846\uFF1A",prop:"radio"},{default:n(()=>[l(m,{modelValue:e.form.radio,"onUpdate:modelValue":a[3]||(a[3]=o=>e.form.radio=o)},{default:n(()=>[(c(!0),C(k,null,A(e.radioData,o=>(c(),_($,{key:o.value,label:o.value},{default:n(()=>[y(D(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var Y=S(W,[["render",X]]);const Z=N({name:"crudTable",components:{Table:j,Layer:Y},setup(){const e=B({input:""}),a=B({show:!1,title:"\u65B0\u589E",showButton:!0}),s=B({index:1,size:20,total:0}),f=v(!0),d=v([]),h=v([]),u=m=>{h.value=m},i=m=>{f.value=!0,m&&(s.index=1);let g={page:s.index,pageSize:s.size,...e};z(g).then(t=>{let o=t.data.list;Array.isArray(o)&&o.forEach(b=>{const T=L.find(E=>E.value===b.choose);T?b.chooseName=T.label:b.chooseName=b.choose;const V=q.find(E=>E.value===b.radio);V?b.radioName=V.label:b.radio}),d.value=t.data.list,s.total=Number(t.data.pager.total)}).catch(t=>{d.value=[],s.index=1,s.total=0}).finally(()=>{f.value=!1})},F=m=>{let g={ids:m.map(t=>t.id).join(",")};O(g).then(t=>{M({type:"success",message:"\u5220\u9664\u6210\u529F"}),i(d.value.length===1)})},p=()=>{a.title="\u65B0\u589E\u6570\u636E",a.show=!0,delete a.row},$=m=>{a.title="\u7F16\u8F91\u6570\u636E",a.row=m,a.show=!0};return i(!0),{Plus:K,Search:Q,Delete:R,query:e,tableData:d,chooseData:h,loading:f,page:s,layer:a,handleSelectionChange:u,handleAdd:p,handleEdit:$,handleDel:F,getTableData:i}}}),x={class:"layout-container"},ee={class:"layout-container-form flex space-between"},ae={class:"layout-container-form-handle"},le={class:"layout-container-form-search"},oe={class:"layout-container-table"};function te(e,a,s,f,d,h){const u=r("el-button"),i=r("el-popconfirm"),F=r("el-input"),p=r("el-table-column"),$=r("Table"),m=r("Layer"),g=J("loading");return c(),C("div",x,[w("div",ee,[w("div",ae,[l(u,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:n(()=>[y(D(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),l(i,{title:e.$t("message.common.delTip"),onConfirm:a[0]||(a[0]=t=>e.handleDel(e.chooseData))},{reference:n(()=>[l(u,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:n(()=>[y(D(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])]),w("div",le,[l(F,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=t=>e.query.input=t),placeholder:e.$t("message.common.searchTip"),onChange:a[2]||(a[2]=t=>e.getTableData(!0))},null,8,["modelValue","placeholder"]),l(u,{type:"primary",icon:e.Search,class:"search-btn",onClick:a[3]||(a[3]=t=>e.getTableData(!0))},{default:n(()=>[y(D(e.$t("message.common.search")),1)]),_:1},8,["icon"])])]),w("div",oe,[H((c(),_($,{ref:"table",page:e.page,"onUpdate:page":a[4]||(a[4]=t=>e.page=t),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:n(()=>[l(p,{prop:"name",label:"\u540D\u79F0",align:"center"}),l(p,{prop:"number",label:"\u6570\u5B57",align:"center"}),l(p,{prop:"chooseName",label:"\u9009\u62E9\u5668",align:"center"}),l(p,{prop:"radioName",label:"\u5355\u9009\u6846",align:"center"}),l(p,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:n(t=>[l(u,{onClick:o=>e.handleEdit(t.row)},{default:n(()=>[y(D(e.$t("message.common.update")),1)]),_:2},1032,["onClick"]),l(i,{title:e.$t("message.common.delTip"),onConfirm:o=>e.handleDel([t.row])},{reference:n(()=>[l(u,{type:"danger"},{default:n(()=>[y(D(e.$t("message.common.del")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[g,e.loading]]),e.layer.show?(c(),_(m,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):I("",!0)])])}var me=S(Z,[["render",te]]);export{me as default};
